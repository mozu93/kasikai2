# 会議室予約システム (ローカル版)

## 概要

このシステムは、会議室の予約状況をWebブラウザで確認するためのアプリケーションです。

`申し込みデータ` フォルダに置かれた予約CSVファイルを処理し、Webページでカレンダー形式の予約状況を表示します。
バックグラウンドで常時稼働し、データの更新処理は完全自動化されています。

**このバージョンはGoogleスプレッドシートを使用せず、すべてのデータはPCのローカル環境で完結します。**

## システム構成

1.  **`setup.bat`**: 初回のみ実行するセットアップファイル。必要なフォルダの作成とライブラリのインストールを自動で行います。
2.  **`run_host_services.bat`**: アプリケーション全体を起動するバッチファイル。システムトレイにアイコンが常駐します。
3.  **`host_app.py`**: システムトレイ常駐のメインプログラム。以下の２つのプロセスをバックグラウンドで起動・管理します。
    *   **`upload_script.py`**: `申し込みデータ` フォルダを常に監視し、ファイルが追加・変更されると約5秒後に、内容を検証・重複排除して、ローカルのデータファイル(`data/processed_bookings.csv`)を更新します。
    *   **`app.py`**: FlaskのWebサーバー。ブラウザからのリクエストに応じてローカルのデータファイルから最新の予約データを取得し、Webページを生成します。

## 主な機能

*   **設定エディタ**: `run_config_editor.bat`を実行することで、GUIで会議室名やポップアップ表示項目を簡単に設定できます。
*   **会議室名の設定**: `config.json`を編集することで、会議室の名称や表示順を自由に設定できます。
*   **ポップアップ表示項目の設定**: `config.json`を編集することで、予約詳細ポップアップに表示する項目を自由に選択できます。
*   **カレンダー表示**: 予約状況を月・週・日単位で表示します。
*   **詳細情報表示**: 予約セルクリックで詳細情報をポップアップ表示します。
*   **全自動データ更新**: `申し込みデータ` フォルダにCSVファイルを置くだaけで、約5秒後に自動的にデータが反映されます。
*   **データクレンジング機能**: 更新時にキャンセル済みの予約は自動で除外され、有効な予約の重複は自動的に1件に統合されます。
*   **バックグラウンド実行**: システムトレイに常駐し、コマンドプロンプトを閉じた状態でも動作します。

## 必要なもの

*   Python 3

## セットアップ手順

1.  **`setup.bat` をダブルクリックして実行します。**
    *   黒い画面が表示され、必要なフォルダの作成と、プログラムの実行に必要なライブラリのインストールが自動で行われます。
    *   「Setup complete!」と表示されたら、セットアップは完了です。何かキーを押してウィンドウを閉じてください。

## 使い方

### 1. アプリケーションの起動

`run_host_services.bat` をダブルクリックします。
PCの右下、システムトレイに青い四角のアイコンが表示されれば起動成功です。

### 2. `config.json` の設定 (GUIエディタを使用)

`run_config_editor.bat` をダブルクリックして実行します。
表示されるGUI画面で、会議室名やポップアップ表示項目を直感的に設定できます。
設定変更後は「設定を保存」ボタンをクリックしてください。

### 3. 毎日の作業（予約データの更新）

1.  毎日ダウンロードする予約情報のCSVファイルを、**`申し込みデータ`** フォルダの中にすべて保存します。
2.  約5秒待つと、データが自動でシステムに反映されます。（手動の操作は不要です）

### 3. 予約状況の確認

Webブラウザで以下のアドレスにアクセスします。
[http://127.0.0.1:5000/](http://127.0.0.1:5000/)

### 5. アプリケーションの終了

システムトレイにある青いアイコンを**右クリック**し、表示されたメニューから「終了」を選択します。

## 他のPCからのアクセス方法

このアプリケーションは、起動したPCだけでなく、同じネットワークに接続された他のPCからも閲覧できます。

### 1. サーバーPCのIPアドレスを確認する

アプリケーションを起動（`run_host_services.bat` を実行）すると、黒い画面（コマンドプロンプト）に以下のようなメッセージが表示されます。この`http://...`で示されるURLが、他のPCからアクセスするためのアドレスです。

```
--- Starting Web Server ---
Access from other devices on the same network using: http://192.168.1.10:5000
-------------------------------------------------
```

もしこの画面を閉じてしまった場合は、コマンドプロンプトで `ipconfig` と入力して実行し、「IPv4 アドレス」の項目を確認してください。

### 2. ファイアウォールの設定

他のPCからのアクセスを許可するため、サーバーPCでファイアウォールの設定が必要な場合があります。

1.  Windows セキュリティ > 「ファイアウォールとネットワーク保護」 > 「詳細設定」を開きます。
2.  「受信の規則」を選択し、「新しい規則」を作成します。
3.  以下の設定で規則を作成します。
    *   **規則の種類**: `ポート`
    *   **プロトコルおよびポート**: `TCP`、特定のローカルポート `5000`
    *   **操作**: `接続を許可する`
    *   **プロファイル**: `ドメイン` と `プライベート` にチェック（職場のネットワーク環境に合わせてください）
    *   **名前**: `会議室予約システム` など分かりやすい名前を付ける

### 3. 他のPCからアクセスする

閲覧したいPCのWebブラウザで、ステップ1で確認したURLアドレスを入力します。

例: `http://192.168.1.10:5000`