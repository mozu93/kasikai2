# 会議室予約システム (ローカル版)

## 概要

このシステムは、会議室の予約状況をWebブラウザで確認するためのアプリケーションです。

`uploads` フォルダに置かれた予約CSVファイルを自動処理し、Webページでカレンダー形式の予約状況を表示します。
システムトレイに常駐し、データの更新処理は完全自動化されています。

**このバージョンはGoogleスプレッドシートを使用せず、すべてのデータはPCのローカル環境で完結します。**

## システム構成

1. **`easy_setup_gui.vbs`**: 初回セットアップ用GUIツール。ダブルクリックするだけで環境構築が完了します。
2. **`server_fixed.py`**: メインアプリケーション。システムトレイ常駐型のWebサーバーです。
3. **`config_editor.pyw`**: GUIベースの設定エディター。会議室名や表示項目を直感的に設定できます。

## 主な機能

### 🎯 **ワンクリックセットアップ**
- `easy_setup_gui.vbs` でPython環境チェック、ライブラリインストール、設定まで全自動
- GUIダイアログでユーザーフレンドリーなセットアップ体験

### 🖥️ **システムトレイ統合**
- Windows システムトレイに常駐
- 右クリックメニューで簡単操作（ブラウザで開く、設定変更、システム情報、終了）
- バックグラウンド動作でリソース効率化

### ⚙️ **高度な設定機能**
- **設定エディタ**: GUIで会議室名、表示項目、CSV列マッピングを簡単設定
- **柔軟なCSV対応**: 様々なCSVフォーマットに対応（エンコーディング自動判定）
- **カスタムカラー**: 会議室ごとの色分け表示

### 📊 **スマートなデータ処理**
- **自動ファイル監視**: `uploads` フォルダを常時監視、CSVファイル追加で即座に処理
- **データクレンジング**: 重複排除、無効データ除外
- **「一日」予約分割**: 一日予約を午前・午後・夜間に自動分割
- **複数エンコーディング対応**: UTF-8、Shift_JIS、CP932など自動判定

### 🌐 **モダンなWebインターフェース**
- **レスポンシブデザイン**: モバイル・タブレット・PC対応
- **リアルタイム更新**: 10秒間隔でデータ自動更新
- **カレンダー表示**: 月・週・日単位の切り替え表示
- **詳細ポップアップ**: 予約情報の詳細表示
- **支払額合計表示**: 日別・期間別の支払額集計
- **検索・フィルター機能**: 会議室、日付、予約者での絞り込み

### 🔒 **安全性とメンテナンス**
- **自動ファイル管理**: 処理済みファイルの自動移動・古いファイルクリーンアップ
- **エラーハンドリング**: 堅牢なエラー処理とログ記録
- **リカバリー機能**: システム異常時の自動復旧

## 必要なもの

- Windows PC
- Python 3.7以上（自動インストール対応）

## セットアップ手順

### 🚀 **簡単セットアップ（推奨）**

1. **`easy_setup_gui.vbs` をダブルクリック**
   - GUIダイアログが表示されます
   - Python環境チェック（未インストールの場合は自動インストール案内）
   - 必要ライブラリの自動インストール
   - フォルダ作成と初期設定

2. **会議室設定（オプション）**
   - セットアップ中に設定エディターが起動
   - 会議室名や表示項目をGUIで設定

3. **システム起動**
   - セットアップ完了後、自動的にシステム起動
   - ブラウザが自動で開きます

### 🛠️ **手動セットアップ**

```bash
# 必要ライブラリのインストール
pip install -r requirements.txt

# 直接起動
python server_fixed.py
```

## 使い方

### 1. **アプリケーションの起動**

**方法1: VBSセットアップから**
- `easy_setup_gui.vbs` をダブルクリック → セットアップ完了後に自動起動

**方法2: 直接起動**
- `python server_fixed.py` を実行

**方法3: バッチファイル**
- `easy_setup.bat` をダブルクリック

### 2. **システムトレイ操作**

PCの右下にある会議室アイコンを右クリック：
- **ブラウザで開く**: http://localhost:5003 を自動で開く
- **設定エディタ**: 会議室設定画面を起動
- **システム情報**: アクセスURL、フォルダ情報を表示
- **終了**: システム終了

### 3. **設定の変更**

**GUI設定エディタ（推奨）**
- システムトレイ → 「設定エディタ」
- または `python config_editor.pyw` を直接実行

**手動設定**
- `config.json` を直接編集

### 4. **予約データの更新**

1. 予約CSVファイルを **`uploads`** フォルダに保存
2. 自動的に処理開始（約2秒後）
3. 処理完了後、ファイルは `processed` フォルダに移動
4. Webページに即座に反映

### 5. **予約状況の確認**

**ローカルアクセス**: http://localhost:5003
**ネットワークアクセス**: http://[PCのIPアドレス]:5003

## 主要な機能とAPI

### Webインターフェース
- `/` - メイン画面（カレンダー表示）
- `/api/config` - 設定情報取得
- `/api/bookings` - 予約データ取得
- `/api/status` - システム状態確認

### システム機能
- **自動ファイル監視**: uploadsフォルダの変更検知
- **データ処理**: CSV読み込み、クレンジング、統合
- **ファイル管理**: 処理済みファイル移動、古いファイル削除
- **リアルタイム更新**: Webページの自動更新

## ネットワーク共有

### 1. **IPアドレス確認**
システム起動時に表示される情報、またはシステムトレイ → 「システム情報」で確認

### 2. **ファイアウォール設定**
Windows Defender ファイアウォール:
- ポート: 5003
- プロトコル: TCP
- 受信規則を追加

### 3. **他のPCからアクセス**
ブラウザで `http://[サーバーPCのIP]:5003` にアクセス

## トラブルシューティング

- **Python未インストール**: `easy_setup_gui.vbs` が自動で案内
- **ライブラリエラー**: `pip install -r requirements.txt` を実行
- **ポート競合**: 他のアプリケーションがポート5003を使用している可能性
- **CSV読み込みエラー**: エンコーディングの問題。ファイルをUTF-8で保存
- **システムトレイ未表示**: 管理者権限で実行

## フォルダ構成

```
kasikai2/
├── easy_setup_gui.vbs      # GUIセットアップ
├── server_fixed.py         # メインアプリケーション
├── config_editor.pyw       # 設定エディター
├── index.html             # Webインターフェース
├── config.json            # 設定ファイル
├── requirements.txt       # 依存ライブラリ
├── data/                  # 処理済みデータ
├── uploads/               # CSVアップロードフォルダ
├── processed/            # 処理済みファイル保存
└── docs/                 # ドキュメント
```

## サポート情報

- **ポート**: 5003
- **対応CSV**: UTF-8, Shift_JIS, CP932, ISO-2022-JP
- **対応ブラウザ**: Chrome, Firefox, Edge, Safari
- **OS**: Windows 10/11
- **Python**: 3.7以上

---

**📞 サポート**: 設定や使用方法でご不明な点がございましたら、システム管理者にお問い合わせください。