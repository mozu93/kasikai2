# 👥 会議室予約システム - ユーザーマニュアル

このマニュアルでは、会議室予約システムの日常的な使用方法を説明します。

## 📋 目次

1. [基本操作](#基本操作)
2. [CSVファイルのアップロード](#csvファイルのアップロード)
3. [予約情報の確認](#予約情報の確認)
4. [設定の変更](#設定の変更)
5. [よくある質問](#よくある質問)

## 🖥️ 基本操作

### システムの起動

1. **デスクトップショートカット**をダブルクリック、または
2. フォルダ内の **`start_server.bat`** をダブルクリック
3. ブラウザが自動で開き、システム画面が表示されます

### システムの終了

1. **ブラウザを閉じる** または
2. **コマンドプロンプト画面で `Ctrl + C`** を押す

### 画面の見方

#### メイン画面構成
```
┌─────────────────┬───────────────────────────────┐
│  サイドバー      │        カレンダー表示          │
│ ・日付選択       │   ┌─────┬─────┬─────┬─────┐   │
│ ・会議室フィルター │   │午前  │午後  │夜間  │一日  │   │
│ ・CSVアップロード │   ├─────┼─────┼─────┼─────┤   │
│                │   │予約A │予約B │予約C │     │   │
└─────────────────┴───────────────────────────────┘
```

#### 色分けの意味
- **薄青色**: 内部利用会議室
- **黄色**: 特別料金（無料など）
- **白色**: 一般利用

## 📤 CSVファイルのアップロード

### アップロード手順

1. **サイドバーの「CSVファイルをアップロード」セクション**を確認
2. **「ファイルを選択」**ボタンをクリック
3. **CSVファイル**を選択（拡張子は .csv のみ）
4. **「アップロード」**ボタンをクリック
5. **進行状況バー**で処理状況を確認
6. **約60秒後**に自動的にデータが反映されます

### CSVファイルの形式

#### 必須ヘッダー
最低限必要なヘッダー項目：
```csv
利用日時(予約内容),会議室(予約内容),案内表示名(予約内容)
```

#### 完全版ヘッダー例
```csv
利用日時(予約内容),会議室(予約内容),合計金額(予約内容),取消日(予約内容),案内表示名(予約内容),事業所名,延長(予約内容),備品(予約内容),備考（ご要望や持込機材などございましたらご入力ください。）,メモ,利用目的(予約内容),会員種別(予約内容),部署名,担当者名,郵便番号,都道府県,市区町村,以降の住所,電話番号
```

#### サンプルデータ
```csv
利用日時(予約内容),会議室(予約内容),案内表示名(予約内容),事業所名,担当者名
2025年01月20日 午前,ホールⅠ,新年度企画会議,株式会社サンプル,田中太郎
2025年01月20日 午後,ホールⅡ,研修会,テスト企業,佐藤花子
2025年01月21日 一日,ホール全,年次総会,大手株式会社,山田次郎
```

### 利用日時の書式

#### 対応している書式
- **日付**: `2025年01月20日` 形式
- **時間帯**: 
  - `午前` → 午前の時間帯
  - `午後` → 午後の時間帯  
  - `夜間` → 夜間の時間帯
  - `一日` → 終日利用
  - `午前・午後` → 午前と午後の複数時間帯
  - `午前・午後・夜間` → 全時間帯

#### 例
```
2025年01月20日 午前      → 1月20日 午前のみ
2025年01月20日 午前・午後 → 1月20日 午前と午後
2025年01月20日 一日      → 1月20日 終日
```

### アップロード時の注意点

#### ファイルサイズ制限
- **最大サイズ**: 16MB
- **推奨サイズ**: 5MB以下（処理速度向上）

#### ファイル形式
- **対応形式**: CSVファイル（.csv）のみ
- **文字エンコード**: UTF-8推奨（Excel の場合は「UTF-8 CSV」で保存）

#### 複数ファイルのアップロード
- 複数のCSVファイルを**短時間で連続アップロード**した場合
- **最後のアップロードから60秒後**に一括処理されます
- 途中でファイルを追加すると、タイマーがリセットされます

## 📅 予約情報の確認

### カレンダー表示

#### 日付の選択
1. **サイドバーの日付選択**で表示したい日を選択
2. カレンダーが選択した日の予約状況を表示

#### 会議室フィルター
1. **サイドバーの会議室一覧**で表示したい会議室をチェック
2. チェックした会議室のみがカレンダーに表示

### 予約詳細の確認

#### 予約ブロックのクリック
1. カレンダー上の**予約ブロックをクリック**
2. **詳細モーダル**が開き、以下の情報が表示されます：
   - 利用日時
   - 会議室名
   - 案内表示名
   - 事業所名
   - 担当者名
   - 延長・備品情報
   - その他の詳細情報

#### 特別な表示

**分割表示会議室**
- 「ホール全」の予約は自動的に「ホールⅠ」と「ホールⅡ」に分割表示
- 実際の利用者には両方の会議室が利用可能

## ⚙️ 設定の変更

### 設定エディターの起動

1. **`run_config_editor.bat`** をダブルクリック
2. **設定エディター**が起動

### 会議室設定の変更

#### 会議室の追加
1. **「会議室表示設定」**タブを選択
2. **「＋追加」**ボタンをクリック
3. 必要な情報を入力：
   - **CSV名**: CSVファイル内の会議室名
   - **表示名**: 画面に表示される名前
   - **ID**: システム内部で使用する識別子

#### 会議室の編集・削除
1. 該当の会議室を選択
2. **「編集」**または**「削除」**ボタンをクリック

### CSVヘッダー設定

#### ヘッダーマッピングの変更
1. **「CSVヘッダー設定」**タブを選択
2. システム項目名に対応する**CSVヘッダー名**を入力
3. **「保存」**ボタンをクリック

#### 新しいヘッダーの追加
1. **「＋追加」**ボタンをクリック
2. **システム項目名**と**CSVヘッダー名**を入力

### 分割表示設定

#### 分割ルールの設定
1. **「会議室分割表示設定」**タブを選択
2. **分割元会議室**と**分割先会議室**を設定
3. **「有効」**チェックボックスで分割機能の ON/OFF を切り替え

## ❓ よくある質問

### 操作に関する質問

**Q: アップロードしたCSVがカレンダーに反映されない**
```
A: 以下を確認してください：
1. アップロード後60秒待つ
2. ブラウザをリフレッシュ（F5キー）
3. CSVヘッダーが設定と一致しているか確認
4. 日付形式が正しいか確認（2025年01月20日 形式）
```

**Q: 会議室が表示されない**
```
A: 以下を確認してください：
1. サイドバーの会議室フィルターがチェックされているか
2. config.json の会議室設定が正しいか
3. CSVファイル内の会議室名が設定と一致しているか
```

**Q: 文字化けが発生する**
```
A: CSVファイルの文字エンコードを確認してください：
1. Excel の場合: 「UTF-8 CSV」で保存
2. テキストエディターの場合: UTF-8で保存
3. BOM付きUTF-8推奨
```

### データに関する質問

**Q: 過去のデータを確認したい**
```
A: 以下の方法があります：
1. 「処理済み」フォルダ内のCSVファイルを確認
2. data/processed_bookings.csv で統合データを確認
3. 必要に応じて過去のCSVファイルを再アップロード
```

**Q: 重複した予約データがある**
```
A: システムは自動的に重複を排除します：
1. 同一日・同一会議室・同一時間帯の予約は1つにまとめられます
2. 最新のアップロードデータが優先されます
```

**Q: 特別料金（無料）の予約を区別したい**
```
A: 合計金額が0円の予約は自動的に黄色で表示されます：
1. CSVの「合計金額(予約内容)」を0にしてください
2. 自動的に特別料金として識別されます
```

### 技術的な質問

**Q: 他のPCからアクセスしたい**
```
A: ネットワーク設定の変更が必要です：
1. app.py のhost設定を変更
2. ファイアウォールの設定変更
3. 詳細は管理者にお問い合わせください
```

**Q: システムが重い・遅い**
```
A: 以下をお試しください：
1. 大量のCSVデータを小分けにしてアップロード
2. ブラウザのキャッシュをクリア
3. PCの再起動
4. 他のアプリケーションを終了
```

**Q: バックアップを取りたい**
```
A: 以下のファイルをバックアップしてください：
1. config.json（設定ファイル）
2. data/processed_bookings.csv（統合データ）
3. 処理済みフォルダ内のCSVファイル
```

## 🚨 緊急時の対応

### システムが起動しない場合

1. **コマンドプロンプトで手動起動**:
   ```cmd
   cd C:\会議室予約システム
   python app.py
   ```

2. **エラーメッセージの確認**:
   - app_debug.log ファイルを確認
   - エラー内容をメモして管理者に連絡

3. **設定ファイルの復旧**:
   - config.json のバックアップから復旧
   - 設定エディターで初期設定を再実行

### データが消えた場合

1. **「処理済み」フォルダの確認**:
   - 過去に処理されたCSVファイルを確認
   - 必要に応じて再アップロード

2. **バックアップからの復旧**:
   - processed_bookings.csv のバックアップを確認
   - data フォルダにコピーして復旧

---

## 📞 サポート

操作で不明な点や問題が発生した場合：

1. **FAQ確認**: よくある質問で同様の問題がないか確認
2. **ログ確認**: app_debug.log でエラー詳細を確認  
3. **管理者連絡**: 問題が解決しない場合は管理者に連絡

---

**📝 このマニュアルは継続的に更新されます。最新版をご確認ください。**