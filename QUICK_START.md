# 🚀 会議室予約システム - クイックスタートガイド

このガイドに従って、**3分で**会議室予約システムを動作させることができます。

## 📋 動作環境

- **OS**: Windows 10/11
- **Python**: 3.7以上（3.9推奨、手動インストール必要）
- **メモリ**: 最低2GB（推奨: 4GB以上）
- **ディスク容量**: 500MB以上

## ⚡ 新しい5ステップセットアップ

### 🎯 **新導入フロー（5ステップ）**

#### ステップ0: 🐍 Python環境の準備（初回のみ）
**Pythonが未インストールの場合のみ実行**

1. **Python公式サイト**: https://www.python.org/downloads/
2. **Python 3.9.x** をダウンロード
3. **⚠️ 重要**: インストール時に「Add Python to PATH」にチェック
4. **確認**: コマンドプロンプトで `python --version` を実行

**PATH設定でエラーが出る場合**:
- 環境変数 → システム環境変数 → Path に以下を追加：
  ```
  C:\Users\[ユーザー名]\AppData\Local\Programs\Python\Python39\
  C:\Users\[ユーザー名]\AppData\Local\Programs\Python\Python39\Scripts\
  ```

#### ステップ1: 📁 基本インストール
1. **`easy_setup_silent.vbs`** をダブルクリック
2. **Python環境チェック**（未インストールの場合は手動インストール案内）
3. **ライブラリ自動インストール**
4. **サンプルデータでシステム自動起動**
5. **ブラウザ自動オープン**: http://localhost:5000

#### ステップ2: 🔍 動作確認
1. **ローカルカレンダー表示**をサンプルデータで確認
2. **システムトレイに青いアイコン**が表示されることを確認

#### ステップ3: 📥 実データダウンロード
1. **KasikaiCSVdl2** で実際のCSVデータをダウンロード
   - 別途提供される予約データダウンロードツール
   - 会議室予約管理システムから最新データを取得
2. **uploadsフォルダ**に自動配置
3. **processed_bookings.csv** が作成される

#### ステップ4: ⚙️ 実組織設定
1. **システムトレイアイコン** → 「設定エディタ」
2. 実際のCSVデータから**会議室設定を読み込み**
3. **カレンダー表示設定完了**

**🎉 本格運用開始！**

### 🛠️ **手動セットアップ（上級者向け）**

#### 方法1: バッチファイル
1. **`easy_setup.bat`** をダブルクリック
2. Python環境確認とライブラリインストール
3. 設定エディター起動オプション
4. システム自動起動

#### 方法2: 直接起動
```bash
# 必要ライブラリのインストール
pip install -r requirements.txt

# 直接起動
python server_fixed.py
```

## 🎯 動作確認

システムが正常に動作していることを確認します：

### 基本動作チェック
1. **ブラウザアクセス**: http://localhost:5000 でシステムが表示される
2. **システムトレイ**: 右下に青いカレンダーアイコンが表示される
3. **システム情報**: トレイアイコン右クリック → 「システム情報」で詳細確認

### データ処理テスト
1. **CSVアップロード**: サンプルCSVファイルをアップロードして動作確認
2. **カレンダー表示**: 予約データがカレンダーに反映される
3. **手動更新**: 「🔄 ステータス更新」ボタンをクリックまたはブラウザリロードで最新データ表示

### 新機能確認
2. **システムトレイ操作**: 右クリックメニューの各機能を確認
3. **フォルダ監視**: `uploads`フォルダにCSVファイルを保存すると自動処理

## 🔗 KasikaiCSVdl2連携

### KasikaiCSVdl2とは？
**KasikaiCSVdl2** は会議室予約システム用の専用CSVダウンロードツールです：
- 会議室予約管理システムから最新の予約データを自動取得
- この予約表示システムと連携して動作
- ダウンロードしたデータは自動的にuploadsフォルダに配置

### 連携フロー
1. **KasikaiCSVdl2** → 予約データダウンロード
2. **uploads フォルダ** → 自動ファイル配置
3. **予約表示システム** → 自動データ処理
4. **processed_bookings.csv** → 統合データ作成
5. **Webカレンダー** → 最新データ表示

### 自動化設定
- KasikaiCSVdl2に自動アップロード機能がある場合は設定可能
- 定期的なデータ更新で常に最新の予約情報を表示
- 手動でも uploads フォルダにファイル配置するだけで処理

---

## 📁 CSVファイルについて

### **サンプルCSVファイル（テスト用）**

初回テスト用のサンプルCSVファイル：

```csv
利用日時(予約内容),会議室(予約内容),案内表示名(予約内容),事業所名,担当者名,合計金額(予約内容)
2025年01月20日 午前,ホールⅠ,新年度企画会議,テスト株式会社,田中太郎,50000
2025年01月20日 午後,ホールⅡ,研修会,サンプル企業,佐藤花子,30000
2025年01月21日 一日,ホール全,年次総会,大手株式会社,山田次郎,150000
2025年01月22日 夜間,ホールⅠ,特別料金イベント,NPO法人,鈴木一郎,0
```

### **CSVファイルの配置方法**

#### 方法1: Webアップロード
1. **サイドバー**の「CSVファイルをアップロード」
2. **複数ファイル選択可能**
3. **進行状況表示**付き

#### 方法2: フォルダ監視（推奨）
1. **`uploads`** フォルダにCSVファイルを保存
2. **約2秒後に自動処理開始**
3. 処理完了後、ファイルは **`processed`** フォルダに移動

### **対応エンコーディング**
- UTF-8, UTF-8-SIG, Shift_JIS, CP932, ISO-2022-JP
- **推奨**: UTF-8-SIG（Excel の「UTF-8 CSV」）

### **新機能: 一日予約の自動分割**
- `一日` → 自動的に `午前`・`午後`・`夜間` に分割表示
- 利用者には全時間帯が利用可能として表示

## 📊 システムトレイ活用

### システムトレイメニュー（右クリック）

#### 🌐 **ブラウザで開く**
- http://localhost:5000 を自動で開く
- 手動でブラウザを開く必要なし

#### ⚙️ **設定エディタ**
- 会議室設定画面を自動起動
- GUIで簡単に設定変更可能

#### 📊 **システム情報**
- **ローカルアクセス**: http://127.0.0.1:5000
- **ネットワークアクセス**: http://[IPアドレス]:5000
- **フォルダパス**: uploads, data, processed
- **システム状態**: 稼働時間、処理済みファイル数

#### 🔚 **終了**
- システム安全終了

## ⚠️ トラブルシューティング

### よくある問題と解決方法

**Python が見つからない**
```
エラー: 'python' は、内部コマンドまたは外部コマンド...
→ easy_setup_silent.vbs が自動でPython公式サイトを開いて案内
→ Python 3.11以上をインストール（PATH設定を忘れずに）
```

**ポート使用中エラー**
```
エラー: Port 5000 is already in use
→ システムが自動的に次のポート (5001～5009) を試行します
→ 複数のポートが使用中の場合は、他のアプリケーションを終了してください
```

**システムトレイアイコンが表示されない**
```
→ Windows通知設定を確認
→ 管理者権限で実行
→ 「隠れているインジケーター」を確認
→ 直接 python server_fixed.py で起動
```

**ブラウザが開かない**
```
→ 手動でブラウザを開き、http://localhost:5000 にアクセス
→ システムトレイ → 「ブラウザで開く」を使用
```

**CSV が反映されない**
```
→ 2秒程度待ってから確認
→ エンコーディングを UTF-8-SIG に変更
→ ヘッダー名が config.json の設定と一致しているか確認
→ システムトレイ → 「システム情報」でログ確認
```

**文字化けが発生する**
```
→ CSVファイルを UTF-8-SIG で保存
→ Excel の場合は「UTF-8 CSV」を選択
→ システムは複数エンコードに対応済み
```

## 🌐 ネットワーク共有設定

### 他のPCからアクセスする方法

#### ステップ1: IPアドレス確認
1. **システムトレイ** → 「システム情報」をクリック
2. **ネットワークアクセスURL**を確認: `http://[IPアドレス]:5000`

#### ステップ2: ファイアウォール設定
1. **Windows Defender ファイアウォール**を開く
2. **受信規則**で新しい規則を作成
3. **ポート5000、TCP**を許可（または5001～5009を許可）

#### ステップ3: アクセステスト
1. 同一ネットワーク内の他のPCから
2. ブラウザで `http://[IPアドレス]:5000` にアクセス

## 📞 サポート

問題が解決しない場合：

### セルフヘルプ
1. **よくある質問**: `USER_MANUAL.md` のFAQセクション
2. **システム情報**: システムトレイから現在の状態確認
3. **ログ確認**: コンソール出力でエラー詳細を確認

### サポート情報
- **アクセスURL**: http://localhost:5000
- **ポート**: 5000（フォールバック: 5001～5009）
- **対応ファイル**: CSV（複数エンコード対応）
- **対応OS**: Windows 10/11
- **Python**: 3.7以上

## 📈 次のステップ

システムが動作したら：

### 基本カスタマイズ
1. **会議室設定**: システムトレイ → 「設定エディタ」で会議室名を設定
2. **CSV列マッピング**: 実際のCSVファイルに合わせてヘッダー設定
3. **分割表示設定**: 必要に応じて会議室分割ルールを設定

### 本格運用準備
1. **ネットワーク共有**: 他のPCからアクセスできるように設定
2. **バックアップ設定**: 重要ファイルの定期バックアップ
3. **運用ルール確立**: CSV更新の担当者と頻度を決定

### 高度な活用
2. **自動化**: CSVファイルの自動配置システム構築
3. **カスタマイズ**: 色分けルールや表示項目の調整

---

## 🎉 成功！

✅ **システムが動作**したら、`USER_MANUAL.md` で全機能を確認し、本格的な運用を開始しましょう！

**🔑 重要なポイント**:
- **システムトレイ**がメインの操作拠点
- **`uploads`フォルダ**への保存で自動処理
- **手動更新**で最新データ表示（「ステータス更新」ボタン またはリロード）
- **複数エンコード対応**で文字化け問題を解決