# 📦 会議室予約システム - 配布版

**汎用会議室予約システム**へようこそ！

このシステムは、会議室の予約状況をWebブラウザで確認するためのローカルアプリケーションです。
CSVデータを美しいカレンダー形式で表示し、システムトレイに常駐してバックグラウンドで動作します。

**Googleスプレッドシートを使用せず、すべてのデータはPCのローカル環境で完結します。**

## 🚀 主な特徴

### 🎯 **ワンクリックセットアップ**
- `easy_setup_silent.vbs` でPython環境チェック、ライブラリインストール、設定まで全自動
- サンプルデータでの即座動作確認

### 🖥️ **システムトレイ統合**
- Windows システムトレイに常駐（青いカレンダーアイコン）
- 右クリックメニューで簡単操作（ブラウザで開く、設定変更、システム情報、終了）
- バックグラウンド動作でリソース効率化

### ⚙️ **高度な設定機能**
- **設定エディタ**: GUIで会議室名、表示項目、CSV列マッピングを簡単設定
- **柔軟なCSV対応**: 様々なCSVフォーマットに対応（エンコーディング自動判定）
- **カスタムカラー**: 会議室ごとの色分け表示

### 📊 **スマートなデータ処理**
- **自動ファイル監視**: `uploads` フォルダを常時監視、CSVファイル追加で即座に処理
- **データクレンジング**: 重複排除、無効データ除外
- **「一日」予約分割**: 一日予約を午前・午後・夜間に自動分割
- **複数エンコーディング対応**: UTF-8、Shift_JIS、CP932など自動判定

### 🌐 **モダンなWebインターフェース**
- **レスポンシブデザイン**: モバイル・タブレット・PC対応
- **手動データ更新**: 「🔄 ステータス更新」ボタンまたはブラウザリロードで更新
- **カレンダー表示**: 月・週・日単位の切り替え表示（月曜日を週の始まりで表示）
- **詳細ポップアップ**: 予約情報の詳細表示
- **検索・フィルター機能**: 会議室、日付、予約者での絞り込み

## 📋 システム要件

- **OS**: Windows 10/11
- **Python**: 3.7以上（3.9推奨、自動インストール案内あり）
- **メモリ**: 2GB以上（4GB推奨）
- **ディスク**: 500MB以上

## ⚡ 新導入フロー（5ステップ）

### ステップ0: 🐍 Python環境の準備（初回のみ）

**Pythonがインストールされていない場合は、まずPythonをインストールしてください。**

#### Python 3.9の手動インストール手順

1. **Pythonダウンロードページにアクセス**
   - https://www.python.org/downloads/
   - 「Download Python 3.9.x」をクリック

2. **インストーラーの実行**
   - ダウンロードした`python-3.9.x-amd64.exe`を実行
   - **⚠️ 重要**: 「Add Python to PATH」に必ずチェックを入れる
   - 「Install Now」をクリック

3. **インストール確認**
   - コマンドプロンプトを開く（Windowsキー + R → cmd → Enter）
   - 以下のコマンドを実行して確認：
   ```cmd
   python --version
   pip --version
   ```
   - バージョン情報が表示されればOK

#### PATH環境変数の確認と設定

**Pythonが認識されない場合**:
1. **コントロールパネル** → **システム** → **システムの詳細設定**
2. **環境変数** → **システム環境変数** → **Path**を選択
3. **編集** → **新規** → 以下のパスを追加：
   ```
   C:\Users\[ユーザー名]\AppData\Local\Programs\Python\Python39\
   C:\Users\[ユーザー名]\AppData\Local\Programs\Python\Python39\Scripts\
   ```
4. **OK** → **OK** → コマンドプロンプトを再起動
5. 再度 `python --version` で確認

### ステップ1: 📁 基本インストール
1. **`easy_setup_silent.vbs` をダブルクリック**
   - Python環境チェック（未インストールの場合は手動インストール案内）
   - 必要ライブラリの自動インストール
   - **サンプルデータでシステム自動起動**
   - **ブラウザ自動オープン**: http://localhost:5003

### ステップ2: 🔍 動作確認
- **ローカルカレンダー表示**をサンプルデータで確認
- **システムトレイに青いアイコン**が表示されることを確認

### ステップ3: 📥 実データダウンロード
- **KasikaiCSVdl2** で実際のCSVデータをダウンロード
  - 別途提供される予約データダウンロードツール
  - 会議室予約管理システムから最新データを取得
- **uploadsフォルダ**に自動配置
- **processed_bookings.csv** が作成される

### ステップ4: ⚙️ 実組織設定
- **システムトレイアイコン** → 「設定エディタ」
- 実際のCSVデータから**会議室設定を読み込み**
- **カレンダー表示設定完了**

**🎉 本格運用開始！**

## 🛠️ 手動セットアップ

```bash
# 必要ライブラリのインストール
pip install -r requirements.txt

# 直接起動
python server_fixed.py
```

## 🔗 KasikaiCSVdl2連携

### 連携システム概要
**KasikaiCSVdl2** は、この会議室予約表示システムと連携する専用のCSVダウンロードツールです。

### 主要機能
- **自動データ取得**: 会議室予約管理システムから最新の予約データを取得
- **自動ファイル配置**: ダウンロードしたCSVファイルをuploadsフォルダに自動配置
- **シームレス連携**: この予約表示システムが自動的にデータを処理
- **統合データ作成**: processed_bookings.csvとして統合されたデータを生成

### 連携フロー
1. **KasikaiCSVdl2** → 予約管理システムからCSVデータダウンロード
2. **uploadsフォルダ** → 自動ファイル配置
3. **予約表示システム** → ファイル監視・自動データ処理
4. **データ統合** → processed_bookings.csv作成
5. **Webカレンダー** → 最新データ表示（手動更新で反映）

## 🎯 設定とカスタマイズ

### 会議室設定の変更
**システムトレイアイコン** → 「設定エディタ」で設定変更

設定エディターで以下をカスタマイズ：
- **会議室表示設定**: 会議室名、表示名、色設定
- **ポップアップ項目設定**: 詳細表示項目の選択
- **分割表示ルール**: 会議室の分割利用設定

### CSV読み込み機能
- **📊 会議室項目設定のためCSV読み込み**: 会議室情報と分割設定を更新
- **📋 ポップアップ項目設定のためCSV読み込み**: 表示項目のみを更新

### CSVファイル形式

#### 最小構成
```csv
利用日時(予約内容),会議室(予約内容),案内表示名(予約内容)
2025年01月20日 午前,ホールⅠ,サンプル会議
```

#### 完全構成
```csv
利用日時(予約内容),会議室(予約内容),案内表示名(予約内容),事業所名,担当者名,合計金額(予約内容)
2025年01月20日 午前,ホールⅠ,企画会議,株式会社サンプル,田中太郎,5000
```

**日時形式**: `2025年01月20日 午前` / `午後` / `夜間` / `一日` / `午前・午後` / `午後・夜間` / `午前・夜間`

## 📚 マニュアル

- **📖 QUICK_START.md**: 5分でシステム稼働
- **📘 SETUP_MANUAL.md**: 詳細セットアップ手順
- **👥 USER_MANUAL.md**: 日常操作マニュアル

## 🔧 設定例

### 例1: 一般的な会議室（4室）
```json
{
  "rooms": [
    {"csv_name": "大会議室", "id": "large-room", "display_name": "大会議室"},
    {"csv_name": "中会議室", "id": "medium-room", "display_name": "中会議室"},
    {"csv_name": "小会議室A", "id": "small-room-a", "display_name": "小会議室A"},
    {"csv_name": "小会議室B", "id": "small-room-b", "display_name": "小会議室B"}
  ]
}
```

### 例2: ホール+会議室（分割利用あり）
```json
{
  "rooms": [
    {"csv_name": "メインホール", "id": "main-hall", "display_name": "メインホール"},
    {"csv_name": "ホール前半", "id": "hall-front", "display_name": "ホール前半"},
    {"csv_name": "ホール後半", "id": "hall-back", "display_name": "ホール後半"},
    {"csv_name": "ホール全体", "id": "hall-combined", "display_name": "ホール全体"}
  ],
  "data_split_rules": [
    {
      "source_room_id": "hall-combined",
      "target_room_ids": ["hall-front", "hall-back"],
      "enabled": true
    }
  ]
}
```

### 例3: CSVヘッダーのカスタマイズ
```json
{
  "csv_column_mapping": {
    "booking_datetime": "予約日時",
    "room_name": "利用施設",
    "display_name": "表示名称",
    "company_name": "団体名",
    "contact_person": "代表者名"
  }
}
```

## 🚨 トラブルシューティング

### よくある問題

**Python が見つからない**
```
解決方法: Python 3.9 を公式サイトからインストール
パス設定を忘れずに行ってください
```

**ポートエラー**
```
エラー: Port 5000 is already in use
解決方法: 他のアプリケーションを終了するか、app.py でポート番号変更
```

**CSV読み込みエラー**
```
解決方法: 
1. UTF-8エンコードで保存
2. ヘッダー名が設定と一致しているか確認
3. 日付形式を確認
```

## 🔄 アップデート

### バージョン確認
現在のバージョン情報は README.md で確認できます。

### アップデート手順
1. 既存の config.json をバックアップ
2. 新しいファイルで上書き
3. config.json を復元
4. 設定の互換性を確認

## 🔒 セキュリティ

### ローカル動作
- システムは localhost（127.0.0.1）でのみ動作
- 外部からのアクセスは制限されています

### ファイルアップロード
- CSVファイルのみアップロード可能
- 16MB のサイズ制限
- セキュアなファイル名処理

### データ保護
- アップロードファイルは自動的にタイムスタンプ付きで保存
- 処理済みファイルは別フォルダに移動
- ログファイルでアクティビティ追跡

## 📞 サポート

### バグ報告・機能要望
GitHub Issues でお気軽にご連絡ください：
[GitHub Repository URL]

### FAQ
よくある質問と回答は USER_MANUAL.md をご確認ください。

### コミュニティ
ユーザー同士の情報交換：
[コミュニティフォーラム URL]

## 📄 ライセンス

MIT License - 商用利用・改変・再配布自由

## 🙏 謝辞

このシステムは以下のオープンソースライブラリを使用しています：
- **Flask**: Webアプリケーションフレームワーク
- **Pandas**: データ処理
- **Watchdog**: ファイル監視
- **Tailwind CSS**: UIスタイリング

---

**🎉 会議室予約システムをお楽しみください！**

何かご不明な点がございましたら、遠慮なくお問い合わせください。