# 📖 会議室予約システム - 詳細セットアップマニュアル

本マニュアルでは、会議室予約システムの完全なセットアップ手順を説明します。

## 📋 目次

1. [システム要件](#システム要件)
2. [インストール手順](#インストール手順)
3. [設定ファイルの詳細](#設定ファイルの詳細)
4. [カスタマイズ方法](#カスタマイズ方法)
5. [トラブルシューティング](#トラブルシューティング)
6. [運用・保守](#運用保守)

## 🖥️ システム要件

### 必須要件
- **OS**: Windows 10 (version 1903以降) / Windows 11
- **Python**: 3.7以上（3.9以上を強く推奨）
- **メモリ**: 最低2GB（推奨: 4GB以上）
- **ディスク容量**: 500MB以上の空き容量
- **ネットワーク**: インターネット接続（初期セットアップ時）

### 推奨環境
- **CPU**: Intel Core i3以上またはAMD Ryzen 3以上
- **メモリ**: 8GB以上
- **ディスク**: SSD推奨（応答速度向上）

## 🔧 インストール手順

### Step 1: Pythonのインストール

1. **Python公式サイト**にアクセス: https://www.python.org/downloads/
2. **Python 3.9.x**をダウンロード
3. インストーラーを実行し、**「Add Python to PATH」にチェック**
4. コマンドプロンプトで確認:
   ```cmd
   python --version
   pip --version
   ```

### Step 2: システムファイルの配置

1. **配布パッケージ**を任意のフォルダに解凍
   - 推奨: `C:\会議室予約システム\`
   - 避ける: スペースや日本語を含むパス（トラブル回避）

2. **フォルダ構成確認**:
   ```
   会議室予約システム/
   ├── app.py              # メインアプリケーション
   ├── config.json         # 設定ファイル
   ├── setup.bat          # セットアップスクリプト
   ├── start_server.bat   # サーバー起動スクリプト
   ├── config_editor.pyw  # 設定エディター
   └── docs/              # マニュアル類
   ```

### Step 3: 依存関係のインストール

**自動インストール（推奨）**:
```cmd
setup.bat
```

**手動インストール**:
```cmd
pip install flask flask-cors pandas watchdog
```

### Step 4: 初期設定

1. **設定エディターの起動**:
   ```cmd
   run_config_editor.bat
   ```

2. **基本設定の確認・変更**:
   - アプリケーション名
   - 会議室名とID
   - CSVヘッダーマッピング

## ⚙️ 設定ファイルの詳細

### config.json の構造

```json
{
  "rooms": [
    {
      "csv_name": "ホールⅠ",     // CSVファイル内の会議室名
      "id": "hall-1",           // システム内部ID
      "display_name": "ホールⅠ"  // 画面表示名
    }
  ],
  "csv_column_mapping": {
    "booking_datetime": "利用日時(予約内容)",
    "room_name": "会議室(予約内容)",
    "display_name": "案内表示名(予約内容)"
  },
  "data_split_rules": [
    {
      "source_room_id": "hall-combined",
      "target_room_ids": ["hall-1", "hall-2"],
      "enabled": true
    }
  ]
}
```

### 設定項目の詳細説明

#### 1. rooms配列
各会議室の設定を定義します。

- **csv_name**: CSVファイル内で使用される会議室名（完全一致）
- **id**: システム内部で使用する一意ID（英数字のみ推奨）
- **display_name**: ユーザーに表示される会議室名

#### 2. csv_column_mapping
CSVファイルのヘッダー名とシステム内部の項目名をマッピングします。

**対応可能な項目**:
- booking_datetime: 利用日時
- room_name: 会議室名
- display_name: 案内表示名
- company_name: 事業所名
- contact_person: 担当者名
- total_amount: 合計金額
- cancellation_date: 取消日
- その他カスタム項目

#### 3. data_split_rules
会議室の分割表示ルールを設定します。

**用途**: 「ホール全」を「ホールⅠ」と「ホールⅡ」に分割表示

## 🎨 カスタマイズ方法

### 会議室設定の変更

#### 新しい会議室の追加
```json
{
  "csv_name": "新会議室A",
  "id": "new-room-a", 
  "display_name": "新会議室A"
}
```

#### 内部利用会議室の指定
```json
"internal_room_ids": ["executive-room", "staff-room"]
```

### CSVヘッダーの対応

#### カスタムヘッダーの追加
```json
"csv_column_mapping": {
  "custom_field": "カスタム項目(予約内容)",
  "special_note": "特記事項"
}
```

### UI言語の変更

#### モーダル表示項目のカスタマイズ
```json
"modal_fields": {
  "利用日時(予約内容)": "利用日時(予約内容)",
  "新しい項目": "新しい項目"
}
```

## 🚨 トラブルシューティング

### よくある問題と解決方法

#### 1. Pythonインストール関連

**問題**: `'python' は、内部コマンドまたは外部コマンド...`
```
解決方法:
1. Pythonが正しくインストールされているか確認
2. 環境変数PATHにPythonが追加されているか確認
3. コマンドプロンプトを再起動
```

**問題**: `pip install` でエラーが発生
```
解決方法:
1. 管理者権限でコマンドプロンプトを起動
2. pip を最新版にアップデート: python -m pip install --upgrade pip
3. ファイアウォール設定を確認
```

#### 2. アプリケーション起動関連

**問題**: `Port 5000 is already in use`
```
解決方法:
1. 既存のアプリケーションを終了
2. app.py内のポート番号を変更 (例: 5001)
3. タスクマネージャーでpython.exeプロセスを終了
```

**問題**: ブラウザが自動で開かない
```
解決方法:
1. 手動でブラウザを開く
2. http://localhost:5000 にアクセス
3. ファイアウォール設定を確認
```

#### 3. CSV処理関連

**問題**: CSVファイルが読み込めない
```
解決方法:
1. 文字エンコードを確認（UTF-8推奨）
2. CSVヘッダー名がconfig.jsonと一致しているか確認
3. ファイル形式がCSV（.csv）になっているか確認
```

**問題**: 日本語が文字化けする
```
解決方法:
1. CSVファイルをUTF-8-BOMで保存
2. Excel の場合: 「UTF-8 CSV」形式で保存
3. config.jsonの文字エンコードを確認
```

#### 4. 設定エディター関連

**問題**: 設定エディターが起動しない
```
解決方法:
1. tkinter がインストールされているか確認
2. Python標準ライブラリの再インストール
3. config_editor.pyw を Python.exe で直接起動
```

### ログファイルの確認

システムの詳細な動作状況は以下のログファイルで確認できます：

- **app_debug.log**: アプリケーションのデバッグログ
- **コンソール出力**: リアルタイムの処理状況

### パフォーマンス最適化

#### メモリ使用量の最適化
```python
# config.json に追加可能な設定
"performance_config": {
  "cache_duration": 5,     // キャッシュ保持時間（秒）
  "max_file_size": 16,     // 最大ファイルサイズ（MB）
  "upload_delay": 60       // アップロード処理遅延（秒）
}
```

## 🔄 運用・保守

### 定期メンテナンス

#### 1. ログファイルの管理
- 月1回: ログファイルのサイズ確認
- 必要に応じて古いログを削除

#### 2. システムアップデート
- Python のセキュリティアップデート確認
- 依存関係ライブラリの更新

#### 3. バックアップ
- config.json の定期バックアップ
- 処理済みCSVファイルのアーカイブ

### セキュリティ注意事項

#### 1. ネットワークアクセス
- デフォルトでは localhost（127.0.0.1）のみアクセス可能
- 他のPCからアクセスする場合はファイアウォール設定が必要

#### 2. ファイルアップロード
- 16MB の ファイルサイズ制限
- CSVファイル以外のアップロード制限
- セキュアなファイル名処理

### 障害対応

#### システム停止時の対応
1. **ログファイル確認**: app_debug.log でエラー詳細を確認
2. **プロセス確認**: タスクマネージャーでPythonプロセスを確認
3. **再起動**: start_server.bat で再起動
4. **設定確認**: config.json の設定内容を確認

#### データ復旧
1. **処理済みフォルダ**: 過去の処理済みCSVファイルを確認
2. **バックアップ**: 定期バックアップからの復旧
3. **ログ解析**: 処理履歴の確認

---

## 📞 サポート・問い合わせ

技術的な問題や不明な点がございましたら：

1. **GitHub Issues**: バグ報告・機能要望
2. **メール サポート**: 個別対応が必要な場合
3. **FAQ**: よくある質問と回答

---

**📝 このマニュアルは継続的に更新されます。最新版をご確認ください。**